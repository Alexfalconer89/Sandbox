{"job":{"components":{"197056":{"id":197056,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-16,"y":0,"width":32,"height":32,"inputConnectorIDs":[197065],"outputSuccessConnectorIDs":[197067],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[197064,197071],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n\n#now = datetime.now().strftime(\"_%Y%m%d_%H%M%S\")\n#test_apiKey = \"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\n#apiKey = \"3_-EqS8CpQIhhOyJ-72wU5wj52eLvYPd21mNpN4RWr3OSvHTms_tVNU_prPefWTC3f\"\n\nfrom GSSDK import *\n\ncursor = context.cursor()\ncursor.execute(\"select ciam_uid, ciam_code, value from ${Database}.temp.gigya_daily_extract_name_urn where ciam_uid = 'bbd4b37b69dd40c5a70786a8bc02699d'\")\nsuppExtract = cursor.fetchall()\n\nprint(suppExtract)\n\nif len(suppExtract) == 0:\n    exit(0)\napiKey = \"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\nsecretKey = \"s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\"\nuserKey = \"AJ+8e4/MSXJt\"\n\nmethod = \"accounts.setAccountInfo\"\ncounter = 0\n\n\nfor ciam_uid, ciam_code, value in suppExtract:\n    params = {\"UID\": ciam_uid, \"subscriptions\": \"{\\\"\" + ciam_code + \".email.isSubscribed\\\": \\\"\" + value + \"\\\"}\"}\n    request = GSRequest(apiKey, secretKey, method, params, True, userKey)\n    request.setAPIDomain(\"accounts.eu1.gigya.com\")\n    response = request.send()\n    if response.getErrorCode() == 0:\n        counter += 1\n        print(\"error\")\n    else:\n      \tprint(\"success\")\n        #exit(0)\n        \ncursor.close()\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"197057":{"id":197057,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-224,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[197065,197066],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"197060":{"id":197060,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576485,"x":-74,"y":145,"width":32,"height":32,"inputConnectorIDs":[197064],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Bash Script 2"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###    secretKey = \"s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\"\n\ncurl -X POST \\\n    https://accounts.eu1.gigya.com/accounts.deleteAccount \\\n    -H 'content-type: application/x-www-form-urlencoded' \\\n--data-urlencode \"apikey=3_-EqS8CpQIhhOyJ-72wU5wj52eLvYPd21mNpN4RWr3OSvHTms_tVNU_prPefWTC3f\" \\\n--data-urlencode \"secret=s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\" \\\n--data-urlencode \"userkey=AJ+8e4/MSXJt\" \\\n--data-urlencode \"UID=bbd4b37b69dd40c5a70786a8bc02699d\" \\"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"4":{"slot":4,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"197061":{"id":197061,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576485,"x":101,"y":101,"width":32,"height":32,"inputConnectorIDs":[197071],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Bash Script 1"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###    secretKey = \"s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\"\n\ncurl -X POST \\\n    https://accounts.eu1.gigya.com/accounts.setAccountInfo \\\n    -H 'content-type: application/x-www-form-urlencoded' \\\n--data-urlencode \"apikey=3_-EqS8CpQIhhOyJ-72wU5wj52eLvYPd21mNpN4RWr3OSvHTms_tVNU_prPefWTC3f\" \\\n--data-urlencode \"secret=s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\" \\\n--data-urlencode \"userkey=AJ+8e4/MSXJt\" \\\n    --data-urlencode \"UID=bbd4b37b69dd40c5a70786a8bc02699d\" \\\n    --data-urlencode \"subscriptionID='UKsmababy_SBmktemail'\" \\\n    --data-urlencode \"email.isSubscribed='false'\" \\"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"4":{"slot":4,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"197062":{"id":197062,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-192,"y":112,"width":32,"height":32,"inputConnectorIDs":[197066],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Scott testing"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n\n#now = datetime.now().strftime(\"_%Y%m%d_%H%M%S\")\n#test_apiKey = \"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\n#apiKey = \"3_-EqS8CpQIhhOyJ-72wU5wj52eLvYPd21mNpN4RWr3OSvHTms_tVNU_prPefWTC3f\"\n\nfrom GSSDK import *\n\ncursor = context.cursor()\ncursor.execute(\"select ciam_uid, ciam_code, value from ${Database}.temp.gigya_daily_extract_name_urn where ciam_uid = 'bbd4b37b69dd40c5a70786a8bc02699d'\")\nsuppExtract = cursor.fetchall()\n\nprint(suppExtract)\n\n#if len(suppExtract) == 0:\n#    exit(0)\napiKey = \"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\nsecretKey = \"s0h8TR8MEE/5Se6zWMlh2ENKaIz6DmzS\"\nuserKey = \"AJ+B8e4/MSXJt\"\n\nmethod = \"accounts.setAccountInfo\"\ncounter = 0\n\n\nfor ciam_uid, ciam_code, value in suppExtract:\n    params = {\"UID\": ciam_uid, \"subscriptions\": \"{\\\"\" + ciam_code + \".email.isSubscribed\\\": \\\"\" + value + \"\\\"}\"}\n    try:\n       request = GSRequest(apiKey, secretKey, method, params, True, userKey)\n    except:\n       print(\"asdsa\")\n    request.setAPIDomain(\"accounts.eu1.gigya.com\")\n    response = request.send()\n    print(response)\n    if response.getErrorCode() == 0:\n        counter += 1\n        print(\"error\")\n    else:\n      \tprint(\"success\")\n        #exit(0)\n        \ncursor.close()\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"197063":{"id":197063,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576485,"x":105,"y":10,"width":32,"height":32,"inputConnectorIDs":[197067],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Bash Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are exported into bash, but should be considered read-only: \n#    echo $myvar\n###\n#test_apiKey = \"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\n#apiKey = \"3_-EqS8CpQIhhOyJ-72wU5wj52eLvYPd21mNpN4RWr3OSvHTms_tVNU_prPefWTC3f\"\n#mykey=\"3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\"\n#mysecrent\"KXTHFA1Yen+COteT+N+lreccwDDgn6et\"\n#myuser\"AEqZY/chvFLF\"\n\n\ncurl -X POST \\\nhttps://accounts.eu1.gigya.com/accounts.search \\\n-H 'content-type: application/x-www-form-urlencoded' \\\n--data-urlencode \"apikey=3_6RoLknx1pcICkmIz9P3epjUlvn1SlAlZ8ngwQsSEVUfu08DTvQMc9ebUZiUQO0j7\" \\\n--data-urlencode \"secret=KXTHFA1Yen+COteT+N+lreccwDDgn6et\" \\\n--data-urlencode \"userkey=AEqZY/chvFLF\" \\\n--data-urlencode \"query=SELECT count(*) FROM accounts\" \\"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"4":{"slot":4,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"197067":{"id":197067,"sourceID":197056,"targetID":197063}},"failureConnectors":{},"unconditionalConnectors":{"197064":{"id":197064,"sourceID":197056,"targetID":197060},"197065":{"id":197065,"sourceID":197057,"targetID":197056},"197066":{"id":197066,"sourceID":197057,"targetID":197062},"197071":{"id":197071,"sourceID":197056,"targetID":197061}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"Gigya API Post Updates","description":"Updates to consumers posted to Gigya API","type":"ORCHESTRATION","tag":"e531c5da-170b-42ac-9b75-1e0239f6c4f9"}}