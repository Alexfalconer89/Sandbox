{"job":{"components":{"196504":{"id":196504,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1214167305,"x":-720,"y":-32,"width":32,"height":32,"inputConnectorIDs":[196508],"outputSuccessConnectorIDs":[196511],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FullReg_SingleRecord"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NHSc_NplusHub_F5API_Reg_LIVE"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Items.birth"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Items.city"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Items.country"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Items.created"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Items.first_name"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Items.honorific"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Items.identification_number"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Items.interest_categories"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"Items.interest_topics"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"Items.last_name"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"Items.mail"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"Items.number"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"Items.optin"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"Items.patients"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"Items.phone"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"Items.postcode"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"Items.speciality"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"Items.state"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"Items.street"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"Items.uid"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"Items.university"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"Items.updated"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"Success"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Other"},"2":{"slot":2,"type":"STRING","value":"DataUID=${DataUID}"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Database}"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STAGING"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NHSC_NPLUSHUB_FULLREG"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Bucket}"}}}},"visible":true},"18":{"slot":18,"name":"Primary Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Items.uid"}}}},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REST"}}}},"visible":false},"100":{"slot":100,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NHSc NplusHub F5 API"}}}},"visible":true},"499":{"slot":499,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Other"}}}},"visible":true},"500":{"slot":500,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"501":{"slot":501,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"502":{"slot":502,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"503":{"slot":503,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"504":{"slot":504,"name":"Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"505":{"slot":505,"name":"Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"506":{"slot":506,"name":"Add Authorization To","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Request Header"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1993":{"slot":1993,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Gzip"}}}},"visible":true},"63319":{"slot":63319,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":false},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63322":{"slot":63322,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Existing Amazon S3 Location"}}}},"visible":true},"88342":{"slot":88342,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":true},"88343":{"slot":88343,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88344":{"slot":88344,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"88345":{"slot":88345,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196505":{"id":196505,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-832,"y":-32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[196508],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196510":{"id":196510,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-592,"y":-32,"width":32,"height":32,"inputConnectorIDs":[196511],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"InsertIntoDB"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"--to ensure we aren't duplicating rows\ndelete from ${Database}.db.nhsc_nplushub_fullreg\nwhere UID = ${DataUID} and source_date = current_date()\n;\n\n\ninsert into ${Database}.db.nhsc_nplushub_fullreg\nselect\n  'REG_NHSC_NPLUS|'||\"Items.uid\" as name_urn,\n  \"Items.uid\",\n  \"Items.mail\",\n  \"Items.first_name\",\n  \"Items.last_name\",\n  \"Items.birth\",\n  \"Items.honorific\",\n  \"Items.postcode\",\n  \"Items.street\",\n  \"Items.number\",\n  \"Items.city\",\n  \"Items.state\",\n  \"Items.country\",\n  \"Items.optin\",\n  \"Items.speciality\",\n  \"Items.patients\",\n  \"Items.interest_categories\",\n  \"Items.interest_topics\",\n  to_date(\"Items.created\"),\n  to_date(\"Items.updated\"),\n  'REG_NHSC_NPLUS' as source,\n  'F5_api_NHSC_NPLUSHUB_FULLREG'||to_varchar(current_timestamp(),'YYYYMMDD_hhmiss') as source_file,\n  nvl((select max(source_urn) from ${Database}.db.nhsc_nplushub_fullreg),0)+1 as source_urn,\n  current_date() as source_date\nfrom ${Database}.staging.nhsc_nplushub_fullreg\nminus\nselect\n  name_urn,           \n  uid,        \n  mail,               \n  first_name,         \n  last_name,          \n  birth,              \n  honorific,          \n  postcode,           \n  street,             \n  number,             \n  city,               \n  state,              \n  country,            \n  optin,              \n  speciality,         \n  patients,           \n  interest_categories,\n  interest_topics,    \n  created_date,       \n  updated_date,       \n  source,\n  'F5_api_NHSC_NPLUSHUB_FULLREG'||to_varchar(current_timestamp(),'YYYYMMDD_hhmiss') as source_file,\n  nvl((select max(source_urn) from ${Database}.db.nhsc_nplushub_fullreg),0)+1 as source_urn,\n  current_date() as source_date\nfrom ${Database}.db.nhsc_nplushub_fullreg\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"196511":{"id":196511,"sourceID":196504,"targetID":196510}},"failureConnectors":{},"unconditionalConnectors":{"196508":{"id":196508,"sourceID":196505,"targetID":196504}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"DataUID":{"definition":{"name":"DataUID","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1"}},"grids":{}},"info":{"name":"NHSc NplusHub FullReg","description":"Nestle NHSc N+Hub F5 API Full Registration details","type":"ORCHESTRATION","tag":"f60a77ea-e48e-4b77-af53-992c48d81b2e"}}