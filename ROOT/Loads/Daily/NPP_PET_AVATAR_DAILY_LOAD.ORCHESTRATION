{"job":{"components":{"196201":{"id":196201,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-464,"y":-64,"width":32,"height":32,"inputConnectorIDs":[196205],"outputSuccessConnectorIDs":[196204],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Table for Avatar Count Email"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \n'<html><style>table, th, td {border: 1px solid black; border-collapse: collapse;}</style><head><head><body>'\n|| 'Below are the total consumers and total pet avatars created as of 7am this morning.</br></br>'\n|| '<table><tr><th>New or Existing</th><th>Total Consumers</th><th>Total Avatars</th></tr>'\n|| listagg('<tr><td >' || new_existing || '</td><td style=\"text-align: center; vertical-align: middle;\">' || consumers || '</td><td style=\"text-align: center; vertical-align: middle;\">' || avatars || '</td></tr>',' ') WITHIN GROUP ( order by new_existing desc )\n|| '</table>'\n|| '</br></br>Please do not reply to this email as it comes from an automated account.</br></br>Thanks</body></html>'\nas email_body\nfrom (\n         select\n             case when ex.user_guid is not null then 'Existing' else 'New' end as new_existing,\n             to_char(count(distinct name_urn),'999,999') as consumers,\n             to_char(count(distinct avatar_guid),'999,999') as avatars\n         from ${Database}.db.npp_pet_avatar_details pa\n         left join ${Database}.db.npp_pet_avatar_existing_consumers ex on ex.user_guid = pa.user_guid\n         group by 1\n     ) a"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"email_body"},"2":{"slot":2,"type":"STRING","value":"EMAIL_BODY"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196203":{"id":196203,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1841964130,"x":-304,"y":-64,"width":32,"height":32,"inputConnectorIDs":[196204],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Avatar Count Email"}}}},"visible":true},"2":{"slot":2,"name":"from","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NestleFileLoader@blueberrywave.com"}}}},"visible":true},"3":{"slot":3,"name":"from_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Database} File Loader"}}}},"visible":true},"4":{"slot":4,"name":"html_body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${email_body} "}}}},"visible":true},"5":{"slot":5,"name":"subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Purina Pet Avatar Report"}}}},"visible":true},"6":{"slot":6,"name":"text_body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"This is text body of email"}}}},"visible":true},"7":{"slot":7,"name":"to","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${AvatarList}"}}}},"visible":true},"8":{"slot":8,"name":"bcc","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" "}}}},"visible":true},"9":{"slot":9,"name":"cc","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" "}}}},"visible":true},"10":{"slot":10,"name":"replyto","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto@blueberrywave.com"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196206":{"id":196206,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":103747008,"x":-624,"y":-64,"width":32,"height":32,"inputConnectorIDs":[196210],"outputSuccessConnectorIDs":[196205],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NPP_PET_AVATAR_DAILY_LOAD"}}}},"visible":true},"2":{"slot":2,"name":"bucket","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Bucket}"}}}},"visible":true},"3":{"slot":3,"name":"client","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Database}"}}}},"visible":true},"4":{"slot":4,"name":"file_set","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NPP_PET_AVATAR_DAILY"}}}},"visible":true},"5":{"slot":5,"name":"zip_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"6":{"slot":6,"name":"file_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"7":{"slot":7,"name":"file_group","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"8":{"slot":8,"name":"bucket_full","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"9":{"slot":9,"name":"files_zipped","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"10":{"slot":10,"name":"zip_extension","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"11":{"slot":11,"name":"zip_full_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"12":{"slot":12,"name":"files_in_folder","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"13":{"slot":13,"name":"bucket_directory","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"14":{"slot":14,"name":"file_set_pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"15":{"slot":15,"name":"file_set_date_format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"16":{"slot":16,"name":"zip_full_bucket_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"17":{"slot":17,"name":"zip_full_name_bucket","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"18":{"slot":18,"name":"base_bucket_directory","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"19":{"slot":19,"name":"working_bucket_directory","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true},"20":{"slot":20,"name":"zip_name","elements":{},"visible":true},"21":{"slot":21,"name":"file_group","elements":{},"visible":true},"22":{"slot":22,"name":"tables_in_set","elements":{},"visible":true},"23":{"slot":23,"name":"tables_in_set_mapping","elements":{},"visible":true},"24":{"slot":24,"name":"full_set_required","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"X"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196207":{"id":196207,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-784,"y":-64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[196210],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"196204":{"id":196204,"sourceID":196201,"targetID":196203},"196205":{"id":196205,"sourceID":196206,"targetID":196201}},"failureConnectors":{},"unconditionalConnectors":{"196210":{"id":196210,"sourceID":196207,"targetID":196206}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"email_body":{"definition":{"name":"email_body","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"NPP_PET_AVATAR_DAILY_LOAD","description":"","type":"ORCHESTRATION","tag":"8b4b9476-d8a3-4f7f-a9f6-45954eb6c8d0"}}