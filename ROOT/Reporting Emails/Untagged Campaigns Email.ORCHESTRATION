{"job":{"components":{"196752":{"id":196752,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-528,"y":32,"width":32,"height":32,"inputConnectorIDs":[196760],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[196766],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If > 0 2"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"campaign_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196753":{"id":196753,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-656,"y":32,"width":32,"height":32,"inputConnectorIDs":[196764],"outputSuccessConnectorIDs":[196760],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Count Untagged Campaigns 2"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"   Select count (distinct ae.campaign_ID) as campaign_check\n         From ${Database}.db.adestra_events ae\n         left join ${Database}.db.adestra_tag_lookup atl on atl.adestra_campaign_ID = ae.campaign_ID\n         where ae.event_name = 'sent_campaign' and atl.campaign_ID is null \n         and event_timestamp > add_months(current_date,'-13') "}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"campaign_check"},"2":{"slot":2,"type":"STRING","value":"CAMPAIGN_CHECK"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196756":{"id":196756,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-800,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[196764,196771],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196757":{"id":196757,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-272,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196770],"outputSuccessConnectorIDs":[196761],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Table for Untagged Campaigns Email"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select \n'<html>'\n||'<style>'\n||'th,'\n||'td {font-family: arial; font-size: 9pt; border: 1px inset;},'\n||'table {font-family: arial; font-size: 9pt; border: 1px outset;}'\n||'</style>'\n||'<head><head>'\n||'<body style = \"font-family: arial; font-size: 9pt;\">'\n||'<h1 style = \"font-family: arial; font-size: 24pt;\">Purina - Untagged Qlik Campaigns Report</h1>'\n||'<h3 style = \"font-family: arial; font-size: 13.5pt;\">Below are the Adestra Campaigns which do not have email tagging set up for Qlik.</h3>'\n|| 'You will need to add the details to the ${Database}.db.adestra_tag_lookup table.</br></br>'\n|| '<table><tr><th>Campaign ID</th><th>Adestra Campaign ID</th><th>Adestra Campaign Name</th></tr>'\n|| listagg(\n              '<tr>'\n              ||'<td style=\"text-align: left; vertical-align: middle;\">'||campaign_id||'</td>'\n              ||'<td style=\"text-align: left; vertical-align: middle;\">'|| adestra_campaign_id||'</td>'\n              ||'<td style=\"text-align: left; vertical-align: middle;\">'||adestra_campaign_name||'</td>'\n              ||'</tr>',\n              ' '\n          )\n   WITHIN GROUP ( order by adestra_campaign_id )\n|| '</table>'\n|| '</br></br>Please do not reply to this email as it comes from an automated account.</br></br>Thanks</body></html>'\nas email_body\nfrom (\n         select distinct\n             ae.campaign_id,\n             ae.adestra_campaign_id,\n             ae.adestra_campaign_name\n         from ${Database}.jobs.ecrm_dashboard_campaign_information ecrm\n         join ${Database}.live.adestra_events ae on ae.adestra_campaign_id = ecrm.adestra_campaign_id\n         where coalesce(message,'') = ''\n  \n  union all \n  \n  \n         Select distinct ae.campaign_ID, '' as campaign_name, ae.campaign_name\n         From ${Database}.db.adestra_events ae\n         left join ${Database}.db.adestra_tag_lookup atl on atl.adestra_campaign_ID = ae.campaign_ID\n         where ae.event_name = 'sent_campaign' and atl.campaign_ID is null \n         and event_timestamp > add_months(current_date,'-13') \n     ) a"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"email_body"},"2":{"slot":2,"type":"STRING","value":"EMAIL_BODY"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196758":{"id":196758,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1841964130,"x":-64,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196761],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Untagged Campaigns Email"}}}},"visible":true},"2":{"slot":2,"name":"from","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto@blueberrywave.com"}}}},"visible":true},"3":{"slot":3,"name":"from_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Database} "}}}},"visible":true},"4":{"slot":4,"name":"html_body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${email_body} "}}}},"visible":true},"5":{"slot":5,"name":"subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Warning - Purina - Untagged Qlik Campaigns Report"}}}},"visible":true},"6":{"slot":6,"name":"text_body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"This is text body of email"}}}},"visible":true},"7":{"slot":7,"name":"to","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"np_data@blueberrywave.com"}}}},"visible":true},"8":{"slot":8,"name":"bcc","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" "}}}},"visible":true},"9":{"slot":9,"name":"cc","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" "}}}},"visible":true},"10":{"slot":10,"name":"replyto","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"auto@blueberrywave.com"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196759":{"id":196759,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-400,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196765,196766],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[196770],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196762":{"id":196762,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-528,"y":-64,"width":32,"height":32,"inputConnectorIDs":[196767],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[196765],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If > 0"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"campaign_check"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196763":{"id":196763,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-656,"y":-64,"width":32,"height":32,"inputConnectorIDs":[196771],"outputSuccessConnectorIDs":[196767],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Count Untagged Campaigns"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select count(distinct campaign_name) as campaign_check from ${Database}.jobs.ecrm_dashboard_campaign_information where coalesce(message,'') = ''"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"campaign_check"},"2":{"slot":2,"type":"STRING","value":"CAMPAIGN_CHECK"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"196760":{"id":196760,"sourceID":196753,"targetID":196752},"196761":{"id":196761,"sourceID":196757,"targetID":196758},"196767":{"id":196767,"sourceID":196763,"targetID":196762}},"failureConnectors":{},"unconditionalConnectors":{"196764":{"id":196764,"sourceID":196756,"targetID":196753},"196770":{"id":196770,"sourceID":196759,"targetID":196757},"196771":{"id":196771,"sourceID":196756,"targetID":196763}},"trueConnectors":{"196765":{"id":196765,"sourceID":196762,"targetID":196759},"196766":{"id":196766,"sourceID":196752,"targetID":196759}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"campaign_check":{"definition":{"name":"campaign_check","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"email_body":{"definition":{"name":"email_body","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{}},"info":{"name":"Untagged Campaigns Email","description":"","type":"ORCHESTRATION","tag":"3067cc46-0dd5-4a8c-81e8-1030d5a51e7d"}}