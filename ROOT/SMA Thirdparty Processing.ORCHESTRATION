{"job":{"components":{"195951":{"id":195951,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-944,"y":144,"width":32,"height":32,"inputConnectorIDs":[195960],"outputSuccessConnectorIDs":[195967],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA Thirdparty URL Outputs Extract"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA Thirdparty URL Outputs Extract"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195952":{"id":195952,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":773867971,"x":-544,"y":144,"width":32,"height":32,"inputConnectorIDs":[195966],"outputSuccessConnectorIDs":[195964],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Encrypted URLs"}}}},"visible":true},"4":{"slot":4,"name":"S3 Object Prefix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${Bucket}/data_out/SMA_Thirdparty_URL/"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${Database}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TEMP"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA_3RD_PARTY_ENCRYPTED_URLS"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BBW_URN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PRE_PROCESSED"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"URL"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NONE"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\\r\\n"}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\\t"}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"0"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR_OR_ESCAPE_SEQUENCE","value":""}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"CHAR","value":""}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"140":{"slot":140,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"141":{"slot":141,"name":"Master Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"142":{"slot":142,"name":"KMS Key Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"143":{"slot":143,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":true},"144":{"slot":144,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*result.*"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195953":{"id":195953,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-544,"y":-144,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Live Records with URL"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"merge into ${Database}.live.cid_sma c\nusing (\n          select\n              xr.cid,\n              xr.name_urn,\n              ur.url\n          from ${Database}.temp.sma_3rd_party_encrypted_urls ur\n          inner join ${Database}.jobs.sma_3rd_party_extract_out ex on ex.bbw_urn = ur.bbw_urn\n          inner join ${Database}.db.sma_thirdparty tp on tp.bbw_urn = ur.bbw_urn\n          inner join ${Database}.live.xref_name_urn xr on xr.name_urn = tp.name_urn\n          inner join ${Database}.live.cid_details_sma cd on cd.cid = xr.cid\n                                                   and lower(cd.email) = lower(ex.email)\n  group by 1,2,3\n      ) u on u.cid = c.cid\n         and u.name_urn = c.live_name_urn\nwhen matched then update\nset c.thirdparty_url = replace(u.url,'https://','');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195954":{"id":195954,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-159239741,"x":-864,"y":-16,"width":32,"height":32,"inputConnectorIDs":[195967],"outputSuccessConnectorIDs":[195956],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQS To Trigger URL Encryption"}}}},"visible":true},"2":{"slot":2,"name":"Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eu-west-1"}}}},"visible":true},"3":{"slot":3,"name":"Queue Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SQSClient}_reporting.fifo"}}}},"visible":true},"4":{"slot":4,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA Thirdparty URL Encryption"}}}},"visible":true},"5":{"slot":5,"name":"Message Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Plain"}}}},"visible":true},"6":{"slot":6,"name":"Message Group Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA_THIRDPARTY"}}}},"visible":true},"7":{"slot":7,"name":"Message Deduplication Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DateForQueue.now().format(\"yyyyMMddHHmmssSSS\")}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195955":{"id":195955,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-656,"y":-16,"width":32,"height":32,"inputConnectorIDs":[195962],"outputSuccessConnectorIDs":[195966],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create URL Table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create or replace table ${Database}.temp.sma_3rd_party_encrypted_urls\n(\n    bbw_urn int,\n    pre_processed varchar(2000),\n    url varchar(2000)\n);"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195958":{"id":195958,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-159239741,"x":-128,"y":144,"width":32,"height":32,"inputConnectorIDs":[195961],"outputSuccessConnectorIDs":[196003],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQS To Trigger Thirdparty Reports"}}}},"visible":true},"2":{"slot":2,"name":"Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"eu-west-1"}}}},"visible":true},"3":{"slot":3,"name":"Queue Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${SQSClient}_reporting.fifo"}}}},"visible":true},"4":{"slot":4,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA Thirdparty Report Refresh"}}}},"visible":true},"5":{"slot":5,"name":"Message Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Plain"}}}},"visible":true},"6":{"slot":6,"name":"Message Group Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMA_THIRDPARTY"}}}},"visible":true},"7":{"slot":7,"name":"Message Deduplication Id","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DateForQueue.now().format(\"yyyyMMddHHmmssSSS\")}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195989":{"id":195989,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-1152,"y":-16,"width":32,"height":32,"inputConnectorIDs":[195965],"outputSuccessConnectorIDs":[195963],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete Old Result File"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\nimport os.path\nimport time\nimport awscli \nimport boto3\nimport botocore\n\ns3 = boto3.resource('s3')\n\n# This job simply deletes the last runs file from S3 prior to us triggering new file creation\nfname= \"data_out/SMA_Thirdparty_URL/thirdparty_url_encryption_result.csv\"\nprint(\"deleting old version of \"+fname)\n\ns3.Object('${Bucket}', fname).delete() \n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1200"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195992":{"id":195992,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-448,"y":-16,"width":32,"height":32,"inputConnectorIDs":[195964],"outputSuccessConnectorIDs":[195959],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update Live Records with URL NEW"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"-- First merge in where data hasnt changed and we know encrypted URL from history table:\nmerge into ${Database}.live.cid_sma c\nusing (\n          with \n          recs as \n            (select h.bbw_urn, h.encrypted_url, h.run_date, row_number() over (partition by h.bbw_urn order by h.run_date desc) as row_number\n                    , o.email, h.email as hist_email, o.LANDING_URL , h.LANDING_URL as hist_landing_url, o.JOINED_REFERENCE, h.JOINED_REFERENCE as hist_joined_reference,  o.TITLE, h.TITLE as hist_title,\n                    o.FIRSTNAME, h.FIRSTNAME as hist_firstname, o.LASTNAME, h.LASTNAME as hist_lastname, o.DUEDATE, h.DUEDATE as hist_duedate, o.DOB1, h.DOB1 as hist_dob1, o.GENDER1, h.GENDER1 as hist_gender1, o.NAME1, h.NAME1 as hist_name1,\n                    o.DOB2, h.DOB2 as hist_dob2, o.GENDER2, h.GENDER2 as hist_gender2, o.NAME2, h.NAME2 as hist_name2, o.DOB3, h.DOB3 as hist_dob3, o.GENDER3, h.GENDER3 as hist_gender3, o.NAME3, h.NAME3 as hist_name3, \n                    o.url, h.url as hist_url\n             from ${Database}.JOBS.SMA_3RD_PARTY_EXTRACT_OUT o\n             join ${Database}.db.sma_3rd_party_encrypted_urls_history h on (o.bbw_urn = h.bbw_urn and h.run_date >= current_date-2) ),\n          matched_data as \n            (select bbw_urn, email,  ENCRYPTED_URL as url\n             from recs \n             where row_number = 1 -- should always get latest url for that bbw_urn when mltiple present\n             and hash(email,landing_url, joined_reference, title, firstname, lastname, duedate, dob1, gender1, name1, dob2, gender2, name2, dob3, gender3, name3, url) \n                = hash( hist_email,hist_landing_url, hist_joined_reference, hist_title, hist_firstname, hist_lastname, hist_duedate, hist_dob1, hist_gender1, hist_name1, \n                        hist_dob2, hist_gender2, hist_name2, hist_dob3, hist_gender3, hist_name3, hist_url) )\n          select\n              xr.cid,\n              xr.name_urn,\n              m.url\n          from matched_data m\n          inner join ${Database}.db.sma_thirdparty tp on tp.bbw_urn = m.bbw_urn\n          inner join ${Database}.live.xref_name_urn xr on xr.name_urn = tp.name_urn\n          inner join ${Database}.live.cid_details_sma cd on (cd.cid = xr.cid and lower(cd.email) = lower(m.email) )\n  group by 1,2,3 \n      ) u \non (u.cid = c.cid and u.name_urn = c.live_name_urn)\nwhen matched then update\nset c.thirdparty_url = replace(u.url,'https://','');\n\n--\n-- Then update the records we have run new encryption for\n-- This used to use full sma_3rd_party_extract_out table and now uses sma_3rd_party_extract_out_url_changes\nmerge into ${Database}.live.cid_sma c\nusing (\n          select\n              xr.cid,\n              xr.name_urn,\n              ur.url\n          from ${Database}.temp.sma_3rd_party_encrypted_urls ur\n          inner join ${Database}.jobs.sma_3rd_party_extract_out_url_changes ex on ex.bbw_urn = ur.bbw_urn\n          inner join ${Database}.db.sma_thirdparty tp on tp.bbw_urn = ur.bbw_urn\n          inner join ${Database}.live.xref_name_urn xr on xr.name_urn = tp.name_urn\n          inner join ${Database}.live.cid_details_sma cd on cd.cid = xr.cid\n                                                   and lower(cd.email) = lower(ex.email)\n  group by 1,2,3\n      ) u on u.cid = c.cid\n         and u.name_urn = c.live_name_urn\nwhen matched then update\nset c.thirdparty_url = replace(u.url,'https://','');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195993":{"id":195993,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-336,"y":144,"width":32,"height":32,"inputConnectorIDs":[195959],"outputSuccessConnectorIDs":[195957],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert to URL History"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into ${Database}.db.sma_3rd_party_encrypted_urls_history \n(select o.*, \n \t\te.pre_processed, \n \t\te.url , \n \t\tcurrent_timestamp \nfrom ${Database}.JOBS.SMA_3RD_PARTY_EXTRACT_OUT_URL_CHANGES o\njoin ${Database}.temp.sma_3rd_party_encrypted_urls e on (e.bbw_urn = o.bbw_urn));"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195994":{"id":195994,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-768,"y":144,"width":32,"height":32,"inputConnectorIDs":[195956],"outputSuccessConnectorIDs":[195962],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Wait for New Result File"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print myvar\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print context.getGridVariable('mygridvar')\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\nimport os.path\nimport time\nimport awscli \nimport boto3\nimport botocore\n\ns3 = boto3.resource('s3')\n\n# This job simply waits for the new file to appear on S3 if the process times out it is generally that the\n# exe which runs on the cleaning server has taken longer than normal\n\nfname= \"data_out/SMA_Thirdparty_URL/thirdparty_url_encryption_result.csv\"\n\nprint(\"waiting for new version of \"+fname)\nwait=0\nwhile True:\n  try:\n      s3.Object('${Bucket}', fname).load() \n  except:\n    time.sleep(5)\n    continue\n  else:\n      break\n\nprint (\"found file \"+fname);\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1800"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195995":{"id":195995,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1056,"y":80,"width":32,"height":32,"inputConnectorIDs":[195963],"outputSuccessConnectorIDs":[195960],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Identify new and changed records"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"-- compare current rec on output to latest rec in hist for that bbw_urn \n-- and recognises new (nothing on history) / changed records (no longer matches latest history)\n-- this table is what we will use to send recs for encryption now\n-- The check for run date is due to the URL having a 4 day expiry\n-- 12/05/2022 A Eadie \n\nCREATE OR REPLACE TABLE ${Database}.JOBS.SMA_3RD_PARTY_EXTRACT_OUT_URL_CHANGES as\nwith recs as\n(select o.bbw_urn, \n \t\th.encrypted_url, \n \t\th.run_date, \n \t\trow_number() over (partition by o.bbw_urn order by h.run_date desc) as row_number,\n\t\to.email, h.email as hist_email, \n \t\to.LANDING_URL , h.LANDING_URL as hist_landing_url, \n \t\to.JOINED_REFERENCE, h.JOINED_REFERENCE as hist_joined_reference,  \n \t\to.TITLE, h.TITLE as hist_title,\n\t\to.FIRSTNAME, h.FIRSTNAME as hist_firstname, \n \t\to.LASTNAME, h.LASTNAME as hist_lastname, \n \t\to.DUEDATE, h.DUEDATE as hist_duedate, \n \t\to.DOB1, h.DOB1 as hist_dob1, \n \t\to.GENDER1, h.GENDER1 as hist_gender1, \n \t\to.NAME1, h.NAME1 as hist_name1,\n\t\to.DOB2, h.DOB2 as hist_dob2, \n \t\to.GENDER2, h.GENDER2 as hist_gender2, \n \t\to.NAME2, h.NAME2 as hist_name2, \n \t\to.DOB3, h.DOB3 as hist_dob3, \n \t\to.GENDER3, h.GENDER3 as hist_gender3, \n \t\to.NAME3, h.NAME3 as hist_name3, \n\t\to.url, h.url as hist_url\nfrom \t${Database}.JOBS.SMA_3RD_PARTY_EXTRACT_OUT o\nleft outer join ${Database}.db.sma_3rd_party_encrypted_urls_history h on (o.bbw_urn = h.bbw_urn and h.run_date >= current_date-2) )\nselect \tbbw_urn,email,landing_url, joined_reference, \n\t\ttitle, firstname, lastname, duedate, \n        dob1, gender1, name1, dob2, gender2, name2, dob3, gender3, name3, url \nfrom recs \nwhere row_number = 1 -- should always get latest url for that bbw_urn when multiple present\n-- then check hash\nand hash(email,landing_url, joined_reference, title, firstname, lastname, duedate, dob1, gender1, name1, dob2, gender2, name2, dob3, gender3, name3, url) \n!= hash(hist_email,hist_landing_url, hist_joined_reference, hist_title, hist_firstname, hist_lastname, hist_duedate, hist_dob1, hist_gender1, hist_name1, \n       hist_dob2, hist_gender2, hist_name2, hist_dob3, hist_gender3, hist_name3, hist_url); "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195996":{"id":195996,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-32,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196003],"outputSuccessConnectorIDs":[196002],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Processing Finished"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into tbw.db.monitoring\n(monitoring_timestamp,client,process,description,sub_description,value)\nselect\nCURRENT_TIMESTAMP::timestamp_ntz\n,'${Database}'\n,'BUILD'\n,'SMA THIRDPARTY PROCESSING'\n,'BUILD'\n,'FINISHED'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195997":{"id":195997,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":96,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196002],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Processing Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195998":{"id":195998,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-240,"y":-16,"width":32,"height":32,"inputConnectorIDs":[195957],"outputSuccessConnectorIDs":[195961],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"History Table Housekeeping"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"delete from ${Database}.db.sma_3rd_party_encrypted_urls_history \nwhere run_date < current_date-7;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"195999":{"id":195999,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1376,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[196001],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Processing Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"196000":{"id":196000,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1264,"y":-16,"width":32,"height":32,"inputConnectorIDs":[196001],"outputSuccessConnectorIDs":[195965],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Completed At","mapTo":"Error_CompletedAt"},"2":{"slot":2,"fromId":null,"fromName":"Component","mapTo":"Error_Component"},"3":{"slot":3,"fromId":null,"fromName":"Duration","mapTo":"Error_Duration"},"4":{"slot":4,"fromId":null,"fromName":"Message","mapTo":"Error_Message"},"5":{"slot":5,"fromId":null,"fromName":"Row Count","mapTo":"Error_RowCount"},"6":{"slot":6,"fromId":null,"fromName":"Started At","mapTo":"Error_StartedAt"},"7":{"slot":7,"fromId":null,"fromName":"Status","mapTo":"Error_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Processing Start"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into tbw.db.monitoring\n(monitoring_timestamp,client,process,description,sub_description,value)\nselect\nCURRENT_TIMESTAMP::timestamp_ntz\n,'${Database}'\n,'BUILD'\n,'SMA THIRDPARTY PROCESSING'\n,'BUILD'\n,'STARTED'\n;\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"195956":{"id":195956,"sourceID":195954,"targetID":195994},"195957":{"id":195957,"sourceID":195993,"targetID":195998},"195959":{"id":195959,"sourceID":195992,"targetID":195993},"195960":{"id":195960,"sourceID":195995,"targetID":195951},"195961":{"id":195961,"sourceID":195998,"targetID":195958},"195962":{"id":195962,"sourceID":195994,"targetID":195955},"195963":{"id":195963,"sourceID":195989,"targetID":195995},"195964":{"id":195964,"sourceID":195952,"targetID":195992},"195965":{"id":195965,"sourceID":196000,"targetID":195989},"195966":{"id":195966,"sourceID":195955,"targetID":195952},"195967":{"id":195967,"sourceID":195951,"targetID":195954},"196002":{"id":196002,"sourceID":195996,"targetID":195997},"196003":{"id":196003,"sourceID":195958,"targetID":195996}},"failureConnectors":{},"unconditionalConnectors":{"196001":{"id":196001,"sourceID":195999,"targetID":196000}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"195985":{"id":195985,"x":-230,"y":106,"width":250,"height":58,"text":"Turn on reporting SQS if Fan finders comes in again","colour":"e6e63c"},"195988":{"id":195988,"x":-653,"y":-235,"width":279,"height":182,"text":"Old Vsn New","colour":"e6e63c"},"195990":{"id":195990,"x":-1373,"y":-226,"width":537,"height":122,"text":"Version Control\n---------------------------------\n05/05/2022 ACE Split out the delete old file (to run before trigger) and Wait for new file (which runs after trigger)\n12/05/2022 ACE Load Speed Improvements - Log history of encrypted data and use for daily rebuild - only send new or changed data to be re-encrypted.","colour":"e6e63c"},"195991":{"id":195991,"x":-1457,"y":136,"width":343,"height":119,"text":"NOTE If the file wait has timed out it is likely the exe on the cleaning server has just taken longer than current timeout.\nIt does not mean the exe failed and the file may well be on S3 - in which case you can restart this orchestration from the Wait for New Result File Step","colour":"d60000"}},"variables":{"CheckVolM":{"definition":{"name":"CheckVolM","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"CheckVolS":{"definition":{"name":"CheckVolS","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"DatabaseStage":{"definition":{"name":"DatabaseStage","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"DateForQueue":{"definition":{"name":"DateForQueue","type":"DATETIME","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"2020-03-19"},"Date_format":{"definition":{"name":"Date_format","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"Encoding":{"definition":{"name":"Encoding","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"Extra_parameters":{"definition":{"name":"Extra_parameters","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":",FIELD_OPTIONALLY_ENCLOSED_BY"},"ExtractDB":{"definition":{"name":"ExtractDB","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"${DatabaseHCP}"},"ExtractDelimiter":{"definition":{"name":"ExtractDelimiter","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"ExtractFolder":{"definition":{"name":"ExtractFolder","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"ExtractSchema":{"definition":{"name":"ExtractSchema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"LIVE"},"Filename":{"definition":{"name":"Filename","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"cid_brand.txt"},"HeaderFlag":{"definition":{"name":"HeaderFlag","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"1"},"OutputSet":{"definition":{"name":"OutputSet","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"BUILD"},"SQSQueue":{"definition":{"name":"SQSQueue","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${SQSClient}_reformat.fifo"},"Schema":{"definition":{"name":"Schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"DB"},"SingleFile":{"definition":{"name":"SingleFile","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"True"},"TableName":{"definition":{"name":"TableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"CID_BRAND"},"Time_format":{"definition":{"name":"Time_format","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"Timestamp_format":{"definition":{"name":"Timestamp_format","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"WarehouseSize":{"definition":{"name":"WarehouseSize","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"XLARGE"}},"grids":{"EmailOutputs":{"definition":{"name":"EmailOutputs","scope":"BRANCH","definitions":[{"name":"TableName","type":"TEXT"},{"name":"Filename","type":"TEXT"},{"name":"ExtractDB","type":"TEXT"},{"name":"ExtractSchema","type":"TEXT"},{"name":"ExtractFolder","type":"TEXT"},{"name":"ExtractDelimiter","type":"TEXT"},{"name":"Date_format","type":"TEXT"},{"name":"Time_format","type":"TEXT"},{"name":"Timestamp_format","type":"TEXT"},{"name":"Encoding","type":"TEXT"},{"name":"Extra_parameters","type":"TEXT"},{"name":"HeaderFlag","type":"DECIMAL"},{"name":"Stage","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["XYZ","X","HCP","TEMP","True","","","","","","","1",""]}]}}},"info":{"name":"SMA Thirdparty Processing","description":"","type":"ORCHESTRATION","tag":"32ef7b6b-03f8-4964-8cab-213530bd7e27"}}